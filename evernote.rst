=========================
How evernote works
=========================

:Author: Gao Peng <funky.gao@gmail.com>
:Revision: $Id$

.. contents:: Table Of Contents
.. section-numbering::

Arch
====

::

            client
        ----------------
          |         |
          | HTTPS   | thrift api
          |         |
        ----------------
          shard router
        ----------------
               |
        ------------------------------------------------------------------------
       | virtual shard node                                                     |
       |                                                                        |
       |                        Heartbeat                                       |
       |         ----------------------------------------------                 |
       |        |                                              |                |
       |  -------------------------------    -------------------------------    |
       | | server1                       |  | server2                       |   |
       | |-------------------------------|  |-------------------------------|   |       /-------+
       | |            Xen                |  |           Xen                 |   |       |       |
       | |-------------------------------|  |-------------------------------|   |-------| mysql |
       | |  PrimaryVM    |  SecondaryVM  |  |  PrimaryVM    |  SecondaryVM  |   |       |       |
       | |      |        |      |        |  |      |        |      |        |   |       +-------/
       | |  /---------+  |  /---------+  |  |  /---------+  |  /---------+  |   |
       | |  |  RAID1  |  |  |  RAID1  |  |  |  |  RAID1  |  |  |  RAID1  |  |   |
       | |  |  DISK   |  |  |  DISK   |  |  |  |  DISK   |  |  |  DISK   |  |   |
       | |  +---------/  |  +---------/  |  |  +---------/  |  +---------/  |   |
       |  ------|----------------|-------    -------|-----------------|-----    |
       |        |                |                  |                 |         |
       |        |                 ------------------                  |         |
       |        |                      DRBD                           |         |
       |        |                                                     |         |
       |         -----------------------------------------------------          |
       |                               DRBD                                     |
       |                                                                        |
        ------------------------------------------------------------------------

